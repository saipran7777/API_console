importScripts("tinyxmlsax.js");importScripts("tinyxmlw3cdom.js");var SafeHtmlUtils={AMP_RE:new RegExp(/&/g),GT_RE:new RegExp(/>/g),LT_RE:new RegExp(/</g),SQUOT_RE:new RegExp(/'/g),QUOT_RE:new RegExp(/"/g),htmlEscape:function htmlEscape(s){if(-1!==s.indexOf("&")){s=s.replace(SafeHtmlUtils.AMP_RE,"&amp;")}if(-1!==s.indexOf("<")){s=s.replace(SafeHtmlUtils.LT_RE,"&lt;")}if(-1!==s.indexOf(">")){s=s.replace(SafeHtmlUtils.GT_RE,"&gt;")}if(-1!==s.indexOf("\"")){s=s.replace(SafeHtmlUtils.QUOT_RE,"&quot;")}if(-1!==s.indexOf("'")){s=s.replace(SafeHtmlUtils.SQUOT_RE,"&#39;")}return s}};function XMLViewer(data){this.xml=null;this.latestError=null;this.cssPrefix=data.cssPrefix||"";var parser=new DOMImplementation;parser.errorChecking=!1;try{this.xml=parser.loadXML(data.xml)}catch(e){throw new Error(parser.translateErrCode(e.code))}}XMLViewer.prototype={getHTML:function getHTML(){var nodes=this.xml.childNodes,nodesCnt=nodes.length;if(0===nodesCnt){return"no xml"}for(var result="<div class=\""+this.cssPrefix+"prettyPrint\" data-expanded=\"true\">",i=0;i<nodesCnt;i++){result+=this.parse(nodes.item(i))}result+="</div>";return result},parse:function parse(node){var parsed="",type=node.nodeType;switch(type){case 1:parsed+=this._parseElement(node);break;case 3:var value=node.nodeValue;value=SafeHtmlUtils.htmlEscape(value);if(""===value){return""}parsed+=this._parseValue(value);break;case 4:parsed+="<span colapse-marker=\"true\" class=\""+this.cssPrefix+"\"><iron-icon more icon=\"arc:expand-more\" class=\""+this.cssPrefix+"\"></iron-icon>"+"<iron-icon less icon=\"arc:expand-less\" class=\""+this.cssPrefix+"\"></iron-icon></span>";parsed+="<span class=\""+this.cssPrefix+"cdata\">&lt;![CDATA[</span>";parsed+="<div collapsible class=\""+this.cssPrefix+"\">";parsed+=SafeHtmlUtils.htmlEscape(node.nodeValue);parsed+="</div><span class=\""+this.cssPrefix+"cdata\">]]&gt;</span>";break;case 7:parsed+="<div class=\""+this.cssPrefix+"processing\">&lt;?xml "+node.nodeValue+" ?&gt;</div>";break;case 8:parsed+="<div class=\""+this.cssPrefix+"comment\">&lt;--";parsed+=node.nodeValue;parsed+="--&gt</div>";break;}parsed="<div class=\""+this.cssPrefix+"node\">"+parsed+"</div>";return parsed},_parseValue:function _parseValue(value){value=value.trim();var css="value";if(!isNaN(value)){css+=" number"}else if("true"===value||"false"===value){css+=" boolean"}else if("null"===value){css+=" null"}value="<span class=\""+this.cssPrefix+css+"\">"+value+"</span>";return value},_parseElement:function _parseElement(node){var childrenCount=node.childNodes.length,parsed="",showArrows=!1;if(1<childrenCount||this._childIsCDATA(node)){parsed+="<span colapse-marker=\"true\" class=\""+this.cssPrefix+"\"><iron-icon more icon=\"arc:expand-more\" class=\""+this.cssPrefix+"\"></iron-icon>"+"<iron-icon less icon=\"arc:expand-less\" class=\""+this.cssPrefix+"\"></iron-icon></span>";showArrows=!0}parsed+="<span class=\""+this.cssPrefix+"punctuation\">&lt;</span>";parsed+="<span class=\""+this.cssPrefix+"tagname\">"+node.nodeName+"</span>";parsed+=this.parseAttributes(node);if(0<childrenCount){var children=node.childNodes;parsed+="<span class=\""+this.cssPrefix+"punctuation\">&gt;</span>";var showInline=!1;if(1===childrenCount&&3===children.item(0).getNodeType()){showInline=!0}if(showInline){parsed+="<div class=\""+this.cssPrefix+"inline\">"}else{parsed+="<div collapse-indicator colapse-marker=\"true\" class=\""+this.cssPrefix+"collapseIndicator\">...</div>";parsed+="<div collapsible class=\""+this.cssPrefix+"nodeMargin\">"}for(var i=0;i<childrenCount;i++){parsed+=this.parse(children.item(i))}parsed+="</div>";if(showArrows){parsed+="<span arrowEmpty class=\""+this.cssPrefix+"arrowEmpty\">&nbsp;</span>"}parsed+="<span class=\""+this.cssPrefix+"punctuation end\">&lt;/</span>";parsed+="<span class=\""+this.cssPrefix+"tagname end\">"+node.nodeName+"</span>";parsed+="<span class=\""+this.cssPrefix+"punctuation\">&gt;</span>"}else{parsed+="<span class=\""+this.cssPrefix+"punctuation\"> /&gt;</span>"}return parsed},_childIsCDATA:function _childIsCDATA(node){if(babelHelpers.instanceof(node.firstChild,DOMCDATASection)){return!0}return!1},parseAttributes:function parseAttributes(node){var parsed="",attr=node.attributes;if(null!==attr&&0<attr.length){for(var i=0;i<attr.length;i++){parsed+=" "+this.getAttributesString(attr.item(i))}}return parsed},getAttributesString:function getAttributesString(attr){var data="<span class=\""+this.cssPrefix+"attname\">",name=attr.getName();name=SafeHtmlUtils.htmlEscape(name);data+=name;data+="</span>";data+="<span class=\""+this.cssPrefix+"punctuation\">=</span>";data+="<span class=\""+this.cssPrefix+"attribute\">&quot;";var value=attr.getValue();value=SafeHtmlUtils.htmlEscape(value);data+=value;data+="&quot;</span>";return data},urlify:function urlify(text){var exp=/([^"\s&;]*:\/\/[^"\s]*)(&quot;)?/gim;return text.replace(exp,"<a class=\""+this.cssPrefix+"\" response-anchor href=\"$1\">$1</a>")}};self.onmessage=function(e){var data=e.data,result="";try{var parser=new XMLViewer(data);result=parser.getHTML();parser=null}catch(e){throw new Error(e.message)}self.postMessage(result)};